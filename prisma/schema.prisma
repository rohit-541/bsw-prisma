
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}


model User{
  id            String        @id   @default(auto())  @map("_id")   @db.ObjectId
  name          String
  kerbrosId     String        @unique
  password      String        
  hostel        Hostels   
  role          String        @default("user")   

  doubts        Doubts[]
}

model Doubts{
  id            String        @id       @default(auto())  @map("_id") @db.ObjectId
  userId        String        @db.ObjectId
  course        String
  text          String  
  status        status       
  imageUrl      String?
  replies       Replies[]
  mentorId      String        @db.ObjectId

  mentor        Mentor        @relation(fields: [mentorId],references: [id])
  user          User          @relation(fields: [userId],references: [id])
}

model Replies{
  id            String        @id   @default(auto()) @map("_id") @db.ObjectId
  userId        String        @db.ObjectId
  replyText     String        
  imageUrl      String
  upVotes       Int
  downVotes     Int
  doubtId       String        @db.ObjectId
  doubt         Doubts        @relation(fields: [doubtId],references: [id])
}

model Mentor{
  id          String          @id       @default(auto())  @map("_id")  @db.ObjectId
  name        String
  contact     Int
  hours       Int             //Store in minutes
  kerbros     String
  email       String

  doubts      Doubts[]
  Sessions    session[]
}

model Otps{
  id          String            @db.ObjectId @id @default(auto()) @map("_id")
  email       String            @unique
  OTP         Int
  dateCreated DateTime          @default(now())
}

model session{
  id          String          @id  @default(auto()) @map("_id") @db.ObjectId
  course      String
  mentorId    String          @db.ObjectId
  startTime   DateTime        @default(now())
  endTime     DateTime        
  joinLink    String
  
  mentor      Mentor          @relation(fields: [mentorId],references: [id])
}

enum status{
  Resolved
  Pending
}

enum Hostels{
  Aravali
  Jwalamukhi
  Nilgiri
  Karakoram
}